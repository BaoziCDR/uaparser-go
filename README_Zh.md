# uaparser-go

[English](README.md) | ç®€ä½“ä¸­æ–‡

[![Go Version](https://img.shields.io/badge/go-1.16+-blue.svg)](https://golang.org)
[![MIT License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Go Report Card](https://goreportcard.com/badge/github.com/BaoziCDR/uaparser-go)](https://goreportcard.com/report/github.com/BaoziCDR/uaparser-go)
[![GoDoc](https://godoc.org/github.com/BaoziCDR/uaparser-go?status.svg)](https://godoc.org/github.com/BaoziCDR/uaparser-go)

> ğŸš€ å¿«é€Ÿã€å¯é çš„ Go è¯­è¨€ User Agent å­—ç¬¦ä¸²è§£æå™¨

ä¸€ä¸ªé«˜æ€§èƒ½çš„ User Agent è§£æåº“ï¼Œæ”¯æŒè‡ªå®šä¹‰æ—¥å¿—è®°å½•ã€ç¼“å­˜ä¼˜åŒ–å’Œçº¿ç¨‹å®‰å…¨æ“ä½œã€‚

**[æŸ¥çœ‹æ–‡æ¡£](README.md)** Â· 
**[æŠ¥å‘ŠBug](https://github.com/BaoziCDR/uaparser-go/issues)** Â· 
**[æå‡ºæ–°ç‰¹æ€§](https://github.com/BaoziCDR/uaparser-go/issues)**

## ç›®å½•

- [uaparser-go](#uaparser-go)
  - [ç›®å½•](#ç›®å½•)
  - [é¡¹ç›®ä»‹ç»](#é¡¹ç›®ä»‹ç»)
    - [ä¸»è¦æ”¹è¿›](#ä¸»è¦æ”¹è¿›)
    - [è®¾è®¡ç›®æ ‡](#è®¾è®¡ç›®æ ‡)
  - [ä¸»è¦ç‰¹æ€§](#ä¸»è¦ç‰¹æ€§)
  - [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
    - [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
    - [å®‰è£…æ­¥éª¤](#å®‰è£…æ­¥éª¤)
    - [åŸºæœ¬ä½¿ç”¨](#åŸºæœ¬ä½¿ç”¨)
    - [ç‰ˆæœ¬æ¯”è¾ƒåŠŸèƒ½](#ç‰ˆæœ¬æ¯”è¾ƒåŠŸèƒ½)
    - [é«˜çº§ç‰ˆæœ¬è§£æ](#é«˜çº§ç‰ˆæœ¬è§£æ)
  - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
  - [é…ç½®é€‰é¡¹](#é…ç½®é€‰é¡¹)
    - [åŸºæœ¬é…ç½®](#åŸºæœ¬é…ç½®)
    - [è‡ªå®šä¹‰æ—¥å¿—è®°å½•](#è‡ªå®šä¹‰æ—¥å¿—è®°å½•)
    - [æ€§èƒ½ä¼˜åŒ–é€‰é¡¹](#æ€§èƒ½ä¼˜åŒ–é€‰é¡¹)
  - [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
    - [ç¼“å­˜æœºåˆ¶](#ç¼“å­˜æœºåˆ¶)
    - [åŠ¨æ€æ’åº](#åŠ¨æ€æ’åº)
    - [å†…å­˜å¯¹é½](#å†…å­˜å¯¹é½)
  - [æ”¯æŒçš„æµè§ˆå™¨](#æ”¯æŒçš„æµè§ˆå™¨)
    - [æ¡Œé¢æµè§ˆå™¨](#æ¡Œé¢æµè§ˆå™¨)
    - [ç§»åŠ¨æµè§ˆå™¨](#ç§»åŠ¨æµè§ˆå™¨)
    - [ç‰¹æ®Šåº”ç”¨](#ç‰¹æ®Šåº”ç”¨)
  - [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
    - [è¿è¡Œæµ‹è¯•](#è¿è¡Œæµ‹è¯•)
    - [è¿è¡Œç¤ºä¾‹](#è¿è¡Œç¤ºä¾‹)
    - [æ€§èƒ½æµ‹è¯•](#æ€§èƒ½æµ‹è¯•)
  - [å¦‚ä½•è´¡çŒ®](#å¦‚ä½•è´¡çŒ®)
    - [è´¡çŒ®æ­¥éª¤](#è´¡çŒ®æ­¥éª¤)
    - [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
  - [ç‰ˆæœ¬å†å²](#ç‰ˆæœ¬å†å²)
  - [è®¸å¯è¯](#è®¸å¯è¯)
  - [è‡´è°¢](#è‡´è°¢)

## é¡¹ç›®ä»‹ç»

UA Parser æ˜¯ä¸€ä¸ªä¸“ä¸º Go è¯­è¨€è®¾è®¡çš„é«˜æ€§èƒ½ User Agent å­—ç¬¦ä¸²è§£æåº“ã€‚å®ƒå¯ä»¥å¿«é€Ÿå‡†ç¡®åœ°ä» User Agent å­—ç¬¦ä¸²ä¸­æå–æµè§ˆå™¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬å·ã€‚

æœ¬é¡¹ç›®åŸºäºä¼˜ç§€çš„ [ua-parser/uap-go](https://github.com/ua-parser/uap-go) é¡¹ç›®æ„å»ºï¼Œåœ¨ç‰ˆæœ¬è§£æèƒ½åŠ›å’Œå®ç”¨å·¥å…·æ–¹é¢è¿›è¡Œäº†é‡å¤§å¢å¼ºã€‚

### ä¸»è¦æ”¹è¿›

- **å¢å¼ºç‰ˆæœ¬è§£æ**: æ”¯æŒä»»æ„ä½æ•°çš„ç‰ˆæœ¬å·è§£æï¼ˆå¦‚ "1.2.3.4.5.6"ï¼‰
- **ç‰ˆæœ¬æ¯”è¾ƒå·¥å…·**: å†…ç½®ç‰ˆæœ¬èŒƒå›´åŒ¹é…å’Œæ¯”è¾ƒå®ç”¨å·¥å…·
- **æ€§èƒ½ä¼˜åŒ–**: å…ˆè¿›çš„ç¼“å­˜å’ŒåŠ¨æ€æ’åºæœºåˆ¶
- **è‡ªå®šä¹‰æ—¥å¿—**: çµæ´»çš„æ—¥å¿—æ¥å£ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§

### è®¾è®¡ç›®æ ‡

- **é«˜æ€§èƒ½**: å†…ç½® LRU ç¼“å­˜å’ŒåŠ¨æ€æ’åºä¼˜åŒ–
- **æ˜“äºä½¿ç”¨**: ç®€æ´çš„ API è®¾è®¡ï¼Œå¼€ç®±å³ç”¨
- **é«˜åº¦å¯é…ç½®**: æ”¯æŒè‡ªå®šä¹‰æ—¥å¿—è®°å½•å’Œæ€§èƒ½è°ƒä¼˜
- **çº¿ç¨‹å®‰å…¨**: æ”¯æŒé«˜å¹¶å‘åœºæ™¯
- **æ‰©å±•åŠŸèƒ½**: ç‰ˆæœ¬æ¯”è¾ƒå’ŒèŒƒå›´åŒ¹é…å®ç”¨å·¥å…·

## ä¸»è¦ç‰¹æ€§

- âœ… **å¿«é€Ÿè§£æ**: è§£æ User Agent å­—ç¬¦ä¸²æå–æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬
- âœ… **å¢å¼ºç‰ˆæœ¬æ”¯æŒ**: è§£æä»»æ„ä½æ•°çš„ç‰ˆæœ¬å·ï¼ˆå¦‚ "1.2.3.4.5.6"ï¼‰
- âœ… **ç‰ˆæœ¬æ¯”è¾ƒ**: å†…ç½®ç‰ˆæœ¬æ¯”è¾ƒå’ŒèŒƒå›´åŒ¹é…å®ç”¨å·¥å…·
- âœ… **é«˜æ€§èƒ½ç¼“å­˜**: å†…ç½® LRU ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤è§£æ
- âœ… **è‡ªå®šä¹‰æ—¥å¿—**: æ”¯æŒä»»æ„å®ç° Logger æ¥å£çš„æ—¥å¿—åº“
- âœ… **åŠ¨æ€ä¼˜åŒ–**: æ ¹æ®ä½¿ç”¨é¢‘ç‡è‡ªåŠ¨ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼é¡ºåº
- âœ… **çº¿ç¨‹å®‰å…¨**: å®Œå…¨æ”¯æŒå¹¶å‘è®¿é—®
- âœ… **å¹¿æ³›å…¼å®¹**: æ”¯æŒæ•°ç™¾ç§æµè§ˆå™¨å’Œè®¾å¤‡è¯†åˆ«

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.16 æˆ–æ›´é«˜ç‰ˆæœ¬

### å®‰è£…æ­¥éª¤

```bash
go get github.com/BaoziCDR/uaparser-go
```

### åŸºæœ¬ä½¿ç”¨

```go
package main

import (
    "fmt"
    "log"
    
    "github.com/BaoziCDR/uaparser-go"
)

func main() {
    // åˆ›å»ºè§£æå™¨
    parser, err := uaparser.NewFromSaved()
    if err != nil {
        log.Fatal(err)
    }

    // è§£æ User Agent å­—ç¬¦ä¸²
    ua := parser.Parse("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36")
    
    fmt.Printf("æµè§ˆå™¨: %s\n", ua.Family)    // Chrome
    fmt.Printf("ç‰ˆæœ¬: %s\n", ua.Version)     // 91.0.4472.124
    fmt.Printf("å®Œæ•´ä¿¡æ¯: %s\n", ua.ToString()) // Chrome 91.0.4472.124
}
```

### ç‰ˆæœ¬æ¯”è¾ƒåŠŸèƒ½

åº“ä¸­åŒ…å«å¼ºå¤§çš„ç‰ˆæœ¬æ¯”è¾ƒå®ç”¨å·¥å…·ï¼š

```go
package main

import (
    "fmt"
    "github.com/BaoziCDR/uaparser-go"
)

func main() {
    // åˆ›å»ºç‰ˆæœ¬å¯æ¯”è¾ƒå¯¹è±¡
    version1 := uaparser.VersionComparable("91.0.4472.124")
    version2 := uaparser.VersionComparable("91.0.4472.125")
    
    // æ¯”è¾ƒç‰ˆæœ¬
    result := version1.Compare(version2)
    if result < 0 {
        fmt.Println("version1 æ¯” version2 æ—§")
    } else if result > 0 {
        fmt.Println("version1 æ¯” version2 æ–°")
    } else {
        fmt.Println("ç‰ˆæœ¬ç›¸åŒ")
    }
    
    // èŒƒå›´åŒ¹é…
    chromeVersion := uaparser.VersionComparable("91.0.4472.124")
    
    // æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦åœ¨ [90.0.0.0, 92.0.0.0) èŒƒå›´å†…
    inRange := uaparser.MatchRange("[90.0.0.0,92.0.0.0)", chromeVersion)
    fmt.Printf("Chrome 91.0.4472.124 åœ¨èŒƒå›´ [90.0.0.0, 92.0.0.0) å†…: %v\n", inRange)
    
    // æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦å¤§äº 90.0.0.0
    isNewer := uaparser.MatchRange("(90.0.0.0,)", chromeVersion)
    fmt.Printf("Chrome 91.0.4472.124 æ¯” 90.0.0.0 æ–°: %v\n", isNewer)
}
```

### é«˜çº§ç‰ˆæœ¬è§£æ

ä¸åŸå§‹ ua-parser å®ç°ä¸åŒï¼Œæœ¬åº“æ”¯æŒä»»æ„ä½æ•°çš„ç‰ˆæœ¬å·ï¼š

```go
package main

import (
    "fmt"
    "log"
    "github.com/BaoziCDR/uaparser-go"
)

func main() {
    parser, err := uaparser.NewFromSaved()
    if err != nil {
        log.Fatal(err)
    }

    // è§£æå¤æ‚ç‰ˆæœ¬å·
    testCases := []string{
        "CustomBrowser/1.2.3.4.5.6",
        "MyApp/10.15.7.21.1050.2.1",
        "Enterprise/2023.1.15.build.12345",
    }
    
    for _, ua := range testCases {
        result := parser.Parse(ua)
        fmt.Printf("UA: %s\n", ua)
        fmt.Printf("æµè§ˆå™¨: %s, ç‰ˆæœ¬: %s\n\n", result.Family, result.Version)
    }
}
```

## é¡¹ç›®ç»“æ„

```
uaparser/
â”œâ”€â”€ parser.go              # æ ¸å¿ƒè§£æå™¨å®ç°
â”œâ”€â”€ user_agent.go         # User Agent æ•°æ®ç»“æ„
â”œâ”€â”€ logger.go             # æ—¥å¿—æ¥å£å’Œå®ç°
â”œâ”€â”€ option.go             # é…ç½®é€‰é¡¹
â”œâ”€â”€ cache.go              # ç¼“å­˜å®ç°
â”œâ”€â”€ comparable.go         # ç‰ˆæœ¬æ¯”è¾ƒå·¥å…·
â”œâ”€â”€ defualt_yaml.go       # å†…ç½®æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™
â”œâ”€â”€ test/                 # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ parser_test.go    # å•å…ƒæµ‹è¯•
â”œâ”€â”€ example/              # ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ example.go        # ç¤ºä¾‹ä»£ç 
â”œâ”€â”€ README.md             # è‹±æ–‡æ–‡æ¡£
â”œâ”€â”€ README_Zh.md          # ä¸­æ–‡æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â””â”€â”€ go.mod                # Go æ¨¡å—å®šä¹‰
```

## é…ç½®é€‰é¡¹

### åŸºæœ¬é…ç½®

```go
parser, err := uaparser.NewFromSaved(
    uaparser.WithLogger(myLogger),           // è‡ªå®šä¹‰æ—¥å¿—å™¨
    uaparser.WithDebugMode(true),            // å¯ç”¨è°ƒè¯•æ¨¡å¼
    uaparser.WithUseSort(true),              // å¯ç”¨æ’åºä¼˜åŒ–
    uaparser.WithMissesThreshold(1000000),   // ç¼“å­˜é”™å¤±é˜ˆå€¼
    uaparser.WithMatchIdxNotOk(25),          // åŒ¹é…ç´¢å¼•é˜ˆå€¼
)
```

### è‡ªå®šä¹‰æ—¥å¿—è®°å½•

```go
// ä½¿ç”¨å†…ç½®çš„é»˜è®¤æ—¥å¿—å™¨
logger := uaparser.NewDefaultLogger()

// æˆ–ä½¿ç”¨è‡ªå®šä¹‰æ—¥å¿—å™¨
type MyLogger struct{}

func (l *MyLogger) Infof(format string, args ...interface{}) {
    // å®ç°æ‚¨çš„æ—¥å¿—é€»è¾‘
}

parser, _ := uaparser.NewFromSaved(uaparser.WithLogger(&MyLogger{}))
```

### æ€§èƒ½ä¼˜åŒ–é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ | æ¨èåœºæ™¯ |
|-----|------|--------|----------|
| `WithUseSort` | å¯ç”¨åŠ¨æ€æ’åºä¼˜åŒ– | `false` | é«˜å¹¶å‘åœºæ™¯ |
| `WithMissesThreshold` | è§¦å‘é‡æ’åºçš„é”™å¤±æ¬¡æ•° | `500,000` | æ ¹æ®å¹¶å‘é‡è°ƒæ•´ |
| `WithMatchIdxNotOk` | å®šä¹‰"ä¸è‰¯åŒ¹é…"çš„ç´¢å¼•é˜ˆå€¼ | `20` | æ ¹æ®ä¸»è¦ç”¨æˆ·ç¾¤ä½“è°ƒæ•´ |

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜æœºåˆ¶

- **LRU ç¼“å­˜**: è‡ªåŠ¨ç¼“å­˜è§£æç»“æœï¼Œé¿å…é‡å¤è®¡ç®—
- **ç¼“å­˜å¤§å°**: é»˜è®¤ 1024 æ¡è®°å½•
- **å‘½ä¸­ç‡**: åœ¨å…¸å‹åº”ç”¨ä¸­å¯è¾¾ 95% ä»¥ä¸Š

### åŠ¨æ€æ’åº

```go
// å¯ç”¨åŠ¨æ€æ’åºï¼Œå¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šè‡ªåŠ¨ç§»åˆ°å‰é¢
parser, _ := uaparser.NewFromSaved(
    uaparser.WithUseSort(true),
    uaparser.WithMissesThreshold(100000), // é™ä½é˜ˆå€¼ä»¥æ›´é¢‘ç¹åœ°ä¼˜åŒ–
)
```

### å†…å­˜å¯¹é½

æ‰€æœ‰å…³é”®æ•°æ®ç»“æ„éƒ½ç»è¿‡å†…å­˜å¯¹é½ä¼˜åŒ–ï¼Œåœ¨ 64 ä½ç³»ç»Ÿä¸Šæ€§èƒ½æœ€ä½³ã€‚

## æ”¯æŒçš„æµè§ˆå™¨

### æ¡Œé¢æµè§ˆå™¨
- Chromeã€Firefoxã€Safariã€Edge
- Internet Explorerã€Opera
- å„ç§åŸºäº Chromium çš„æµè§ˆå™¨

### ç§»åŠ¨æµè§ˆå™¨  
- Chrome Mobileã€Firefox Mobileã€Safari Mobile
- å¾®ä¿¡å†…ç½®æµè§ˆå™¨ã€QQ æµè§ˆå™¨ã€UC æµè§ˆå™¨
- ç™¾åº¦æµè§ˆå™¨ã€å°ç±³æµè§ˆå™¨ã€åä¸ºæµè§ˆå™¨

### ç‰¹æ®Šåº”ç”¨
- Electron åº”ç”¨ã€WebView
- çˆ¬è™«å’Œæœºå™¨äºº
- å„ç§ API å®¢æˆ·ç«¯

## å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./test/ -v

# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test ./test/ -bench=. -benchmem
```

### è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡ŒåŸºæœ¬ç¤ºä¾‹
go run ./example/example.go
```

### æ€§èƒ½æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æ€§èƒ½æµ‹è¯•ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å„ç§é…ç½®é€‰é¡¹çš„æ•ˆæœã€‚

## å¦‚ä½•è´¡çŒ®

è´¡çŒ®è®©å¼€æºç¤¾åŒºæˆä¸ºå­¦ä¹ ã€å¯å‘å’Œåˆ›é€ çš„ç»ä½³åœºæ‰€ã€‚æ‚¨çš„ä»»ä½•è´¡çŒ®éƒ½æ˜¯**éå¸¸æ„Ÿè°¢**çš„ã€‚

### è´¡çŒ®æ­¥éª¤

1. **Fork** æœ¬é¡¹ç›®
2. åˆ›å»ºæ‚¨çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ä¸€ä¸ª **Pull Request**

### å¼€å‘è§„èŒƒ

- è¯·ç¡®ä¿ä»£ç é€šè¿‡æ‰€æœ‰æµ‹è¯•
- éµå¾ª Go è¯­è¨€ä»£ç è§„èŒƒ
- ä¸ºæ–°åŠŸèƒ½æ·»åŠ ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ç‰ˆæœ¬å†å²

- **v1.0.0** - åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
  - åŸºæœ¬çš„ User Agent è§£æåŠŸèƒ½
  - å†…ç½®ç¼“å­˜æœºåˆ¶
  - è‡ªå®šä¹‰æ—¥å¿—æ”¯æŒ

æŸ¥çœ‹ [ç‰ˆæœ¬å‘å¸ƒ](https://github.com/BaoziCDR/uaparser-go/releases) è·å–è¯¦ç»†çš„ç‰ˆæœ¬å†å²ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è‡´è°¢

- **åŸºäº [ua-parser/uap-go](https://github.com/ua-parser/uap-go)**: æœ¬é¡¹ç›®å»ºç«‹åœ¨å®˜æ–¹ ua-parser Go å®ç°æä¾›çš„ä¼˜ç§€åŸºç¡€ä¹‹ä¸Š
- æ„Ÿè°¢ [hashicorp/golang-lru](https://github.com/hashicorp/golang-lru) æä¾›çš„ LRU ç¼“å­˜å®ç°
- æ„Ÿè°¢ [yaml.v2](https://gopkg.in/yaml.v2) æä¾›çš„ YAML è§£ææ”¯æŒ
- æ„Ÿè°¢ [ua-parser ç¤¾åŒº](https://github.com/ua-parser) ç»´æŠ¤æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰
- æ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…

---

**[â¬† å›åˆ°é¡¶éƒ¨](#uaparser-go)**

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª â­ï¸ å§ï¼
